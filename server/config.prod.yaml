# 生产环境配置文件
# 使用方式: APP_ENV=prod go run main.go 或 export APP_ENV=prod && ./jy-admin

system:
  db-type: mysql                    # 数据库类型: sqlite, mysql, postgres
  oss-type: local                    # 对象存储类型: local, minio, qiniu, oss
  router-prefix: '/api/'             # API 路由前缀
  port: 7777                         # 服务端口
  iplimit-count: 10000              # IP 限制次数（降低，防止攻击）
  iplimit-time: 3600                 # IP 限制时间（秒）
  use-strict-auth: true             # 启用严格认证（生产环境建议开启）
  disable-auto-migrate: true        # 禁用自动迁移（生产环境必须禁用，手动管理数据库）
  read-timeout: 300                 # 读取超时（秒）- 生产环境降低超时时间
  write-timeout: 300                # 写入超时（秒）- 生产环境降低超时时间

jwt:
  # ⚠️ 重要：生产环境必须使用环境变量设置 JWT 密钥！
  # 设置方式: export JWT_SIGNING_KEY="your-very-long-random-secret-key-at-least-32-chars"
  # 如果未设置环境变量，将使用下面的默认值（必须修改为强密钥）
  signing-key: JY-Admin-Production-Change-This-Key-Must-Be-At-Least-32-Chars  # 默认值，建议通过环境变量覆盖
  expires-time: 7d                   # Token 过期时间（生产环境建议 7 天）
  buffer-time: 1d                    # Token 缓冲时间
  issuer: JY-Admin-Production        # JWT 签发者

sqlite:
  path: /var/lib/jy-admin/data       # 数据库文件路径（生产环境使用绝对路径）
  port: ''
  config: ''
  db-name: 'jiangyi_prod'           # 生产环境数据库名
  username: ''
  password: ''
  max-idle-conns: 10                 # 空闲连接数
  max-open-conns: 50                 # 最大打开连接数（生产环境根据实际负载调整）
  log-mode: warn                     # GORM 日志级别（生产环境使用 warn，减少日志）
  log-zap: false                     # 是否使用 zap 记录 GORM 日志

mysql:
  # ⚠️ 如果使用 MySQL，请设置 system.db-type: mysql
  # 并通过环境变量设置数据库密码: export MYSQL_PASSWORD="your-password"
  path: 'mysql'                   # MySQL 主机地址（可以是 IP 或域名）
  port: '3306'                       # MySQL 端口
  config: 'charset=utf8mb4&parseTime=True&loc=Local&timeout=10s&readTimeout=30s&writeTimeout=30s'  # 连接参数
  db-name: 'jy_admin'          # 生产环境数据库名
  username: 'jy_admin'              # 数据库用户名（建议创建专用用户）
  password: ${MYSQL_PASSWORD:change-this-password}  # 数据库密码（建议通过环境变量设置）
  prefix: ''                        # 表前缀（可选）
  engine: 'InnoDB'                  # 存储引擎
  max-idle-conns: 10                # 最大空闲连接数
  max-open-conns: 100               # 最大打开连接数（根据实际负载调整）
  log-mode: warn                    # GORM 日志级别（生产环境使用 warn）
  log-zap: false                    # 是否使用 zap 记录日志
  singular: false                   # 是否使用单数表名

local:
  path: /var/lib/jy-admin/uploads   # 上传文件路径（生产环境使用绝对路径）
  store-path: /var/lib/jy-admin/uploads  # 存储路径

captcha:
  key-long: 6                        # 验证码长度
  img-width: 300                     # 验证码图片宽度
  img-height: 100                    # 验证码图片高度
  open-captcha: 0                    # 开启验证码的失败次数（0 表示始终开启）
  open-captcha-timeout: 3600        # 验证码超时时间（秒）

log:
  level: info                        # 日志级别: debug, info, warn, error（生产环境使用 info）
  format: json                       # 日志格式: json（生产环境使用 JSON，便于日志收集和分析）
  output: file                       # 输出位置: file（生产环境只输出到文件）
  path: /var/log/jy-admin            # 日志文件路径（生产环境使用绝对路径）
  file-name: app.log                 # 日志文件名
  max-size: 100                      # 单个日志文件最大大小(MB)
  max-backups: 30                    # 保留的旧日志文件数量（生产环境保留更多）
  max-age: 90                        # 保留日志文件的最大天数（生产环境保留更久）
  compress: true                     # 是否压缩旧日志文件

